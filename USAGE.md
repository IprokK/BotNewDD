# Как пользоваться платформой

## Разделение по интерфейсам

| Роль | Где работает | Как зайти |
|------|--------------|-----------|
| **Участник (игрок)** | Mini App в боте + чат бота | Кнопка «Открыть игру» в боте |
| **Ведущий станции** | Только на сайте | `/station` |
| **Организатор (админ)** | Только на сайте | `/admin` |

---

## 1. Участник — Mini App + бот

**Mini App** (кнопка «Открыть игру») — основная рабочая область:
- Прогресс команды (статус, очки, текущая станция)
- QR-код команды (показать ведущему для отметки визита)
- Сюжет и подсказки (доставленный контент)
- Диалоги
- Оценка станций (после визита)

**Чат бота** — регистрация, информация, уведомления:
- Регистрация на квест
- Информация о квесте
- Уведомления: добавление в команду, назначение станции, завершение визита

---

## 2. Админка — только на сайте

Вход: `http://localhost:8000/dev/login/YOUR_TG_ID/1?role=ADMIN`

Страницы:

- **`/admin`** — Live Ops Board
- **`/admin/registrations`** — заявки на участие, добавление в команды
- **`/admin/content`** — контент
- **`/admin/dialogues`** — диалоги
- **`/admin/analytics`** — аналитика
- **`/admin/log`** — лог событий

---

## 3. Ведущий станции — только на сайте

Вход: `http://localhost:8000/dev/login/YOUR_TG_ID/1?role=STATION_HOST`  
(перед этим нужно быть добавленным в `station_hosts` в БД)

Страница **`/station`**:

- сканирование QR команды
- старт/завершение визита
- начисление очков, заметки

---

## 4. Mini App для участников

Кнопка «Открыть игру» в боте открывает **Mini App** — основное рабочее пространство участника. Нужен HTTPS (ngrok для локальной разработки).

**Ограничение доступа:** если в `.env` задано `TG_ALLOWED_IDS=123,456` (ваш tg_id и других администраторов), то только эти пользователи увидят mini-app. Остальные увидят страницу «Доступ пока закрыт. Ожидайте информацию в боте». Пустое значение = доступ всем.

---

## 5. Типичный сценарий

1. Участник открывает бота → Регистрация
2. Админ входит на сайт → «Заявки» → добавляет участников в команды
3. Участник получает уведомление «Тебя добавили в команду»
4. Админ назначает станции командам
5. Участники получают уведомления «Вам назначена станция»
6. Ведущий на сайте сканирует QR, отмечает визит
7. Участники получают уведомление о завершении визита и очках
